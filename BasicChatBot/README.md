This is the code from scratch
